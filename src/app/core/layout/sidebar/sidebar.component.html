<div class="h-full flex flex-col">
  <div class="px-4 py-6 border-b border-gray-200">
    <div class="flex items-center gap-3">
      <div class="flex items-center justify-center w-10 h-10 rounded-md bg-blue-100 text-blue-600">
        <span class="material-icons">workspace_premium</span>
      </div>
      <div class="flex flex-col">
        <span class="text-sm font-semibold text-gray-900">{{ 'APP.TITLE' | translate }}</span>
        <span class="text-[11px] text-gray-500">{{ 'APP.SIDEBAR_TAGLINE' | translate }}</span>
      </div>
    </div>
  </div>

  <nav class="flex-1 overflow-y-auto px-3 py-4 space-y-1" role="navigation">
    <ng-container *ngFor="let item of menuItems">
      <ng-container *ngIf="shouldShowMenu(item)">
        <ng-container *ngIf="item.children?.length; else singleLink">
          <button
            type="button"
            class="w-full flex items-center justify-between px-3 py-2 text-sm font-medium text-gray-600 rounded-md hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-blue-500"
            (click)="toggleMenuSection(item.menuKey)"
            [attr.aria-expanded]="openMenu() === item.menuKey"
          >
            <span class="flex items-center gap-3">
              <span class="material-icons text-[20px] text-gray-500">{{ item.icon }}</span>
              <span class="text-left">{{ item.labelKey | translate }}</span>
            </span>
            <span class="material-icons text-[20px] text-gray-500 transition-transform duration-200"
              [ngClass]="{ 'rotate-180': openMenu() === item.menuKey }"
            >
              expand_more
            </span>
          </button>

          <div
            class="mt-1 space-y-1 pl-11"
            *ngIf="openMenu() === item.menuKey"
          >
            <ng-container *ngFor="let child of item.children">
              <ng-container *ngIf="shouldShowMenu(child)">
                <div *ngIf="child.type === 'header'" class="text-xs font-semibold uppercase tracking-wide text-gray-400">
                  {{ child.labelKey | translate }}
                </div>
                <a
                  *ngIf="child.type !== 'header'"
                  [routerLink]="child.route"
                  [routerLinkActive]="['bg-blue-50', 'text-blue-600', 'font-semibold']"
                  [routerLinkActiveOptions]="child.routerLinkActiveOptions || { exact: true }"
                  class="flex items-center gap-2 rounded-md px-3 py-2 text-sm text-gray-600 hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-blue-500"
                  (click)="handleNavigate()"
                >
                  <span class="material-icons text-[18px] text-gray-400">{{ child.icon }}</span>
                  <span>{{ child.labelKey | translate }}</span>
                </a>
              </ng-container>
            </ng-container>
          </div>
        </ng-container>

        <ng-template #singleLink>
          <a
            [routerLink]="item.route"
            [routerLinkActive]="['bg-blue-50', 'text-blue-600', 'font-semibold']"
            [routerLinkActiveOptions]="item.routerLinkActiveOptions || { exact: true }"
            class="flex items-center gap-3 rounded-md px-3 py-2 text-sm text-gray-600 hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-blue-500"
            (click)="handleNavigate()"
          >
            <span class="material-icons text-[20px] text-gray-500">{{ item.icon }}</span>
            <span>{{ item.labelKey | translate }}</span>
          </a>
        </ng-template>
      </ng-container>
    </ng-container>
  </nav>
</div>
